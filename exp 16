#include <stdio.h>
#include <stdlib.h>

struct Employee {
    int empId;
    char name[30];
    float salary;
};

int main() {
    FILE *fp;
    struct Employee emp;
    int choice, id, record;

    fp = fopen("employee.dat", "rb+");
    if (fp == NULL) {
        fp = fopen("employee.dat", "wb+");
        if (fp == NULL) {
            printf("File cannot be created\n");
            return 1;
        }
    }

    while (1) {
        printf("\n1. Add Employee");
        printf("\n2. Display Employee");
        printf("\n3. Update Employee");
        printf("\n4. Exit");
        printf("\nEnter choice: ");
        scanf("%d", &choice);

        switch (choice) {

        case 1:
            printf("Enter Employee ID: ");
            scanf("%d", &emp.empId);
            printf("Enter Name: ");
            scanf("%s", emp.name);
            printf("Enter Salary: ");
            scanf("%f", &emp.salary);

            record = emp.empId - 1;
            fseek(fp, record * sizeof(emp), SEEK_SET);
            fwrite(&emp, sizeof(emp), 1, fp);
            printf("Employee added successfully\n");
            break;

        case 2:
            printf("Enter Employee ID to display: ");
            scanf("%d", &id);

            record = id - 1;
            fseek(fp, record * sizeof(emp), SEEK_SET);
            fread(&emp, sizeof(emp), 1, fp);

            if (emp.empId == 0)
                printf("Employee record not found\n");
            else
                printf("ID: %d\nName: %s\nSalary: %.2f\n",
                       emp.empId, emp.name, emp.salary);
            break;

        case 3:
            printf("Enter Employee ID to update: ");
            scanf("%d", &id);

            record = id - 1;
            fseek(fp, record * sizeof(emp), SEEK_SET);
            fread(&emp, sizeof(emp), 1, fp);

            if (emp.empId == 0) {
                printf("Employee record not found\n");
            } else {
                printf("Enter New Name: ");
                scanf("%s", emp.name);
                printf("Enter New Salary: ");
                scanf("%f", &emp.salary);

                fseek(fp, record * sizeof(emp), SEEK_SET);
                fwrite(&emp, sizeof(emp), 1, fp);
                printf("Employee updated successfully\n");
            }
            break;

        case 4:
            fclose(fp);
            exit(0);

        default:
            printf("Invalid choice\n");
        }
    }

    return 0;
}
