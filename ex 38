#include <stdio.h>
#include <stdlib.h>

int main() {
    int n, i, head, direction;
    int totalHeadMovement = 0;

    printf("Enter number of disk requests: ");
    scanf("%d", &n);

    int requests[n];
    printf("Enter the disk request sequence: ");
    for (i = 0; i < n; i++) {
        scanf("%d", &requests[i]);
    }

    printf("Enter initial head position: ");
    scanf("%d", &head);

    printf("Enter head movement direction (0 = towards 0, 1 = towards max cylinder): ");
    scanf("%d", &direction);

    int maxCylinder;
    printf("Enter maximum cylinder number: ");
    scanf("%d", &maxCylinder);

    // Separate requests into two arrays based on direction
    int left[n], right[n];
    int l = 0, r = 0;
    for (i = 0; i < n; i++) {
        if (requests[i] < head)
            left[l++] = requests[i];
        else
            right[r++] = requests[i];
    }

    // Sort left and right arrays
    for (i = 0; i < l - 1; i++)
        for (int j = i + 1; j < l; j++)
            if (left[i] > left[j]) {
                int temp = left[i];
                left[i] = left[j];
                left[j] = temp;
            }

    for (i = 0; i < r - 1; i++)
        for (int j = i + 1; j < r; j++)
            if (right[i] > right[j]) {
                int temp = right[i];
                right[i] = right[j];
                right[j] = temp;
            }

    printf("\nDisk Head Movement:\n");
    int currentHead = head;

    if (direction == 1) { // Moving towards higher cylinder
        // Serve right first
        for (i = 0; i < r; i++) {
            printf("Move from %d to %d -> Movement = %d\n", currentHead, right[i], abs(right[i] - currentHead));
            totalHeadMovement += abs(right[i] - currentHead);
            currentHead = right[i];
        }
        // Move to max cylinder
        printf("Move from %d to %d -> Movement = %d\n", currentHead, maxCylinder, abs(maxCylinder - currentHead));
        totalHeadMovement += abs(maxCylinder - currentHead);
        currentHead = maxCylinder;
        // Serve left in reverse order
        for (i = l - 1; i >= 0; i--) {
            printf("Move from %d to %d -> Movement = %d\n", currentHead, left[i], abs(left[i] - currentHead));
            totalHeadMovement += abs(left[i] - currentHead);
            currentHead = left[i];
        }
    } else { // Moving towards 0
        // Serve left first in reverse order
        for (i = l - 1; i >= 0; i--) {
            printf("Move from %d to %d -> Movement = %d\n", currentHead, left[i], abs(left[i] - currentHead));
            totalHeadMovement += abs(left[i] - currentHead);
            currentHead = left[i];
        }
        // Move to cylinder 0
        printf("Move from %d to %d -> Movement = %d\n", currentHead, 0, abs(currentHead - 0));
        totalHeadMovement += abs(currentHead - 0);
        currentHead = 0;
        // Serve right
        for (i = 0; i < r; i++) {
            printf("Move from %d to %d -> Movement = %d\n", currentHead, right[i], abs(right[i] - currentHead));
            totalHeadMovement += abs(right[i] - currentHead);
            currentHead = right[i];
        }
    }

    printf("\nTotal Head Movement = %d\n", totalHeadMovement);
    printf("Average Head Movement = %.2f\n", (float)totalHeadMovement / n);

    return 0;
}
