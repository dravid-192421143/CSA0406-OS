#include <stdio.h>

int mutex = 1;   // semaphore for mutual exclusion
int full = 0;    // number of full slots
int empty = 5;   // number of empty slots (buffer size = 5)
int x = 0;       // item counter

void wait(int *s) {
    (*s)--;
}

void signal(int *s) {
    (*s)++;
}

void producer() {
    wait(&empty);
    wait(&mutex);
    x++;
    printf("Producer produces item %d\n", x);
    signal(&mutex);
    signal(&full);
}

void consumer() {
    wait(&full);
    wait(&mutex);
    printf("Consumer consumes item %d\n", x);
    x--;
    signal(&mutex);
    signal(&empty);
}

int main() {
    int n, i;

    printf("1. Produce\n2. Consume\n3. Exit\n");

    for (i = 0; i < 10; i++) {
        printf("\nEnter choice: ");
        scanf("%d", &n);

        switch (n) {
        case 1:
            if (mutex == 1 && empty != 0)
                producer();
            else
                printf("Buffer is full\n");
            break;

        case 2:
            if (mutex == 1 && full != 0)
                consumer();
            else
                printf("Buffer is empty\n");
            break;

        case 3:
            return 0;
        }
    }
    return 0;
}
